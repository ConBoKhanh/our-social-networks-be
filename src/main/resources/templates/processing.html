<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>conbokhanh • Đang xử lý...</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: #000;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            text-align: center;
            max-width: 420px;
            width: 100%;
        }

        .logo {
            font-family: 'Billabong', cursive;
            font-size: 52px;
            color: #f5f5f5;
            margin-bottom: 50px;
        }

        .spinner-container {
            margin-bottom: 40px;
            position: relative;
        }

        .spinner {
            width: 70px;
            height: 70px;
            border: 3px solid #262626;
            border-top: 3px solid #0095f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-text {
            color: #f5f5f5;
            font-size: 20px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .sub-text {
            color: #c7c7c7;
            font-size: 15px;
            line-height: 1.6;
        }

        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 35px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: #363636;
            border-radius: 50%;
            animation: dotPulse 1.4s ease-in-out infinite;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes dotPulse {
            0%, 100% { background: #363636; transform: scale(1); }
            50% { background: #0095f6; transform: scale(1.3); }
        }

        .steps {
            margin-top: 50px;
            text-align: left;
            background: #121212;
            border-radius: 16px;
            padding: 24px;
            border: 1px solid #262626;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 0;
            color: #8e8e8e;
            font-size: 15px;
            border-bottom: 1px solid #262626;
        }

        .step:last-child { border-bottom: none; }

        .step.active { color: #f5f5f5; }
        .step.done { color: #00d26a; }

        .step-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            flex-shrink: 0;
            font-weight: 600;
        }

        .step.pending .step-icon {
            background: #262626;
            color: #8e8e8e;
        }

        .step.active .step-icon {
            background: #0095f6;
            color: #f5f5f5;
        }

        .step.done .step-icon {
            background: #00d26a;
            color: #f5f5f5;
        }

        .step.error {
            color: #ed4956;
        }

        .step.error .step-icon {
            background: #ed4956;
            color: #f5f5f5;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Billabong&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="logo">conbokhanh</div>
        
        <div class="spinner-container">
            <div class="spinner"></div>
        </div>
        
        <div class="status-text" id="statusText">Đang tạo tài khoản...</div>
        <div class="sub-text" id="subText">Vui lòng đợi trong giây lát</div>
        
        <div class="progress-dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>

        <div class="steps">
            <div class="step done" id="step1">
                <div class="step-icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 01.208 1.04l-9 13.5a.75.75 0 01-1.154.114l-6-6a.75.75 0 011.06-1.06l5.353 5.353 8.493-12.739a.75.75 0 011.04-.208z" clip-rule="evenodd" />
                    </svg>
                </div>
                <span>Xác thực Google thành công</span>
            </div>
            <div class="step active" id="step2">
                <div class="step-icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z" clip-rule="evenodd" />
                    </svg>
                </div>
                <span>Đang tạo tài khoản mới...</span>
            </div>
            <div class="step pending" id="step3">
                <div class="step-icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z" />
                        <path d="M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z" />
                    </svg>
                </div>
                <span>Gửi email mật khẩu tạm thời</span>
            </div>
            <div class="step pending" id="step4">
                <div class="step-icon">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd" />
                    </svg>
                </div>
                <span>Chuyển đến trang đổi mật khẩu</span>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        const redirectUrl = /*[[${redirectUrl}]]*/ '/change-password';
        const email = /*[[${email}]]*/ '';
        
        setTimeout(() => {
            document.getElementById('step2').className = 'step done';
            document.getElementById('step2').querySelector('.step-icon').innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 01.208 1.04l-9 13.5a.75.75 0 01-1.154.114l-6-6a.75.75 0 011.06-1.06l5.353 5.353 8.493-12.739a.75.75 0 011.04-.208z" clip-rule="evenodd" />
            </svg>`;
            document.getElementById('step3').className = 'step active';
            document.getElementById('statusText').textContent = 'Đang gửi email...';
            document.getElementById('subText').textContent = 'Mật khẩu tạm thời sẽ được gửi đến ' + email;
        }, 1200);

        setTimeout(() => {
            const emailSent = /*[[${emailSent}]]*/ false;
            const step3 = document.getElementById('step3');
            const step3Icon = step3.querySelector('.step-icon');
            const step3Text = step3.querySelector('span');
            
            if (emailSent) {
                step3.className = 'step done';
                step3Icon.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 01.208 1.04l-9 13.5a.75.75 0 01-1.154.114l-6-6a.75.75 0 011.06-1.06l5.353 5.353 8.493-12.739a.75.75 0 011.04-.208z" clip-rule="evenodd" />
                </svg>`;
                step3Text.textContent = 'Email đã gửi thành công';
                document.getElementById('statusText').textContent = 'Email đã gửi!';
                document.getElementById('subText').textContent = 'Kiểm tra hộp thư của bạn';
            } else {
                step3.className = 'step error';
                step3Icon.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 011.06 0L12 10.94l5.47-5.47a.75.75 0 111.06 1.06L13.06 12l5.47 5.47a.75.75 0 11-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 01-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 010-1.06z" clip-rule="evenodd" />
                </svg>`;
                step3Text.textContent = 'Gửi email thất bại (có thể dùng mật khẩu tạm thời)';
                document.getElementById('statusText').textContent = 'Lưu ý!';
                document.getElementById('subText').textContent = 'Email có thể không gửi được, hãy thử mật khẩu tạm thời';
            }
            
            document.getElementById('step4').className = 'step active';
            document.getElementById('step4').querySelector('.step-icon').innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 01-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 011.06-1.06l7.5 7.5z" clip-rule="evenodd" />
            </svg>`;
        }, 2500);

        setTimeout(() => {
            window.location.href = redirectUrl;
        }, 3500);
    </script>
</body>
</html>
